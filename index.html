<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Wavelength – Mobile (Multi Sync)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <div class="app">

    <div class="panel">
      <div class="turn" id="turnTitle">Wavelength</div>
      <div class="subturn" id="turnSub">Crée une room ou rejoins avec un code.</div>
    </div>

    <div class="panel">
      <div class="pair" id="pair"></div>
    </div>

    <div id="errBox" class="panel hidden"
         style="border:2px solid rgba(255,0,0,.5); background:rgba(255,0,0,.08); color:#fff;">
      <b>Erreur JS</b>
    </div>

    <div class="panel">
      <canvas id="canvas" width="900" height="520"></canvas>

      <div id="sliderWrap" class="sliderWrap hidden">
        <div class="sliderTop">
          <div class="badge">Réglage précis</div>
          <div class="badge">Valeur : <span id="sliderVal">50</span></div>
        </div>
        <input id="needleSlider" type="range" min="0" max="100" step="1" value="50" />
      </div>

      <div id="legendWrap" class="legend hidden" style="max-width:620px; margin:10px auto 0 auto;">
        <span><span class="dot" style="background:var(--green)"></span>Vert ±5 = 4 pts</span>
        <span><span class="dot" style="background:var(--orange)"></span>Orange ±7 = 2 pts</span>
        <span><span class="dot" style="background:var(--red)"></span>Rouge ±11 = 1 pt</span>
      </div>

      <div id="revealNote" class="revealNote hidden">
        Barre blanche épaisse = Psychic. Barres fines = joueurs (couleurs choisies).
      </div>
    </div>

    <div class="panel controls">
      <button id="btnSettings" class="ghost">Paramètres</button>
      <button id="actionBtn" class="primary">—</button>
    </div>

    <div class="panel">
      <div style="font-weight:950; font-size:16px; margin-bottom:10px;">Multijoueur</div>

      <div class="row" style="gap:10px;">
        <button id="btnHost" class="primary" style="flex:1;">Créer une room</button>
        <button id="btnJoin" class="ghost" style="flex:1;">Rejoindre</button>
      </div>

      <div id="multiBox" style="margin-top:12px;" class="hidden">
        <div class="row">
          <div class="field">
            <label>Code room</label>
            <input id="roomCodeInput" type="text" placeholder="ABCD" maxlength="4" />
          </div>
          <div class="field">
            <label>Pseudo</label>
            <input id="playerNameInput" type="text" placeholder="Ton pseudo" maxlength="14" />
          </div>
        </div>
        <div class="row" style="justify-content:flex-end;">
          <button id="btnConfirmJoin" class="primary">OK</button>
        </div>
        <div class="small" style="margin-top:6px;">Le code fait 4 caractères (majuscules).</div>
      </div>

      <div id="roomInfo" class="hidden" style="margin-top:12px;">
        <div class="badge">Room : <b id="roomCodeLabel">----</b></div>
        <div class="small" style="margin-top:8px;">Joueurs connectés :</div>
        <div id="lobbyPlayers" style="margin-top:8px; display:flex; flex-direction:column; gap:8px;"></div>

        <div class="small" style="margin-top:10px;">
          Statut : <b id="roomStatusLabel">—</b>
        </div>
        <div class="small" style="margin-top:6px;" id="roleLabel">—</div>
      </div>
    </div>

    <div class="panel" id="scoresPanel">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
        <div style="font-weight:950; font-size:16px;">Scores (room)</div>
        <button id="btnResetScores" class="ghost">Reset scores</button>
      </div>
      <div id="scores" style="margin-top:10px; display:flex; flex-direction:column; gap:8px;"></div>
    </div>

  </div>

  <!-- Settings overlay -->
  <div id="settingsOverlay" class="overlay">
    <div class="modal">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2>Paramètres</h2>
          <div class="small">Choisis les packs de catégories utilisés pour tirer une catégorie.</div>
        </div>
        <button id="btnCloseSettings" class="ghost">Fermer</button>
      </div>

      <div class="row">
        <div class="field">
          <label>Points pour gagner</label>
          <input id="pointsToWinInput" type="text" inputmode="numeric" placeholder="ex : 20" />
          <div class="small">Le premier qui atteint ce total gagne.</div>
        </div>
      </div>

      <div id="packsList" class="playersList"></div>

      <div class="row" style="justify-content:flex-end;">
        <button id="btnSelectAll" class="ghost">Tout cocher</button>
        <button id="btnSelectNone" class="ghost">Tout décocher</button>
        <button id="btnSaveSettings" class="primary">Enregistrer</button>
      </div>
    </div>
  </div>

  <!-- Winner overlay -->
  <div id="winnerOverlay" class="overlay">
    <div class="modal">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2 id="winnerTitle">Victoire</h2>
          <div class="small" id="winnerSub">Bravo !</div>
        </div>
        <button id="btnCloseWinner" class="ghost">Fermer</button>
      </div>
      <div class="row" style="justify-content:flex-end;">
        <button id="btnContinue" class="primary">OK</button>
      </div>
    </div>
  </div>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
